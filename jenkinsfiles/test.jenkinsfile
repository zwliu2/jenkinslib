#!groovy
@Library('jenkinslib') _

String workspace = "/opt/jenkins/workspace"

//Pipeline
pipeline {
    agent { node {lable "master"
                 customWorkspace "${workspace}"
          }
    }
    options {
        timestamps() //日志会有时间
        skipDefaultCheckout() //删除隐式checkout scm语句
        disableConcurrentBuilds() //禁止并行
        timeout(time: 1, unit: 'HOURS') //流水线超时设置1H
    }
    stages {
        //下载代码
        stage("CloneCode"){
            when {environment name: ''test', value: 'abcd'}
            steps{//步骤
                timeout(time:5, unit:"MINUTES"){
                    script{
                        println('获取代码')
                        print("${test}")
                        input id: 'Test01_id', message: '是否继续下一步操作', ok: '是,继续吧！', parameters: [choice(choices: ['first', 'second'], description: '', name: 'test')], submitter: 'admin,liuzw'
                    }
                }
            }
        }
    }
}
